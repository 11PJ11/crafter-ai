{
  "task_id": "US005-03-01",
  "project_id": "des-us005",
  "task_specification": {
    "task_id": "US005-03-01",
    "title": "Format recovery suggestions with WHY + HOW + Actionable structure",
    "description": "Implement suggestion formatting that includes all three components:\n1. WHY: Educational explanation of failure cause and implications\n2. HOW: Specific steps to fix the issue\n3. Actionable: Command or file path to execute fix\n\nSuggestion Format Example:\n\"The agent left GREEN_UNIT in IN_PROGRESS state, indicating it started but did not complete (typically due to unhandled error or timeout). To recover: Reset the phase status to NOT_EXECUTED by running: `/nw:execute @software-crafter steps/01-01.json`\"\n\nFormatting Guidelines:\n- WHY: 1-2 sentences explaining failure cause\n- HOW: 1-2 sentences describing fix mechanism\n- Actionable: Specific command, path, or field reference\n- Total: 3-4 sentences per suggestion",
    "acceptance_criteria": [
      "WHY clause explains failure mode clearly",
      "HOW clause describes mechanism of fix",
      "Actionable element includes command or path",
      "Suggestions are readable and junior-dev appropriate",
      "All suggestions follow consistent format"
    ]
  },
  "schema_version": "2.0",
  "tdd_cycle": {
    "acceptance_test": {
      "scenario_name": "",
      "test_file": "",
      "test_file_format": "feature",
      "scenario_index": 0,
      "initially_ignored": true,
      "is_walking_skeleton": false,
      "mapped_scenario": {
        "description": "The specific acceptance test scenario this step makes pass",
        "scenario_function": "",
        "scenario_description": "",
        "mapping_type": "feature",
        "valid_mapping_types": [
          "feature",
          "infrastructure",
          "refactoring"
        ],
        "notes": ""
      }
    },
    "expected_unit_tests": [],
    "mock_boundaries": {
      "allowed_ports": [],
      "forbidden_domain_classes": [],
      "in_memory_adapters": []
    },
    "tdd_phase_tracking": {
      "current_phase": "COMPLETE",
      "active_e2e_test": "test_scenario_004_timeout_detect_exceeded_timeout_duration",
      "inactive_e2e_tests": "All other @skip scenarios remain disabled",
      "phases_completed": ["PREPARE", "RED_ACCEPTANCE", "RED_UNIT", "GREEN", "REVIEW", "REFACTOR_CONTINUOUS", "REFACTOR_L4", "COMMIT"],
      "test_results": {
        "total": 34,
        "passed": 34,
        "failed": 0,
        "skipped": 5
      }
    },
    "phase_execution_log": [
      {
        "phase_name": "PREPARE",
        "status": "EXECUTED",
        "started_at": "2026-01-28T14:30:00Z",
        "ended_at": "2026-01-28T14:32:00Z",
        "outcome": "PASS",
        "notes": "Verified acceptance test scenario structure and requirement mapping. Single E2E test enabled for timeout_failure feature implementation.",
        "blocked_by": null
      },
      {
        "phase_name": "RED_ACCEPTANCE",
        "status": "EXECUTED",
        "started_at": "2026-01-28T14:32:00Z",
        "ended_at": "2026-01-28T14:35:00Z",
        "outcome": "PASS",
        "notes": "Acceptance test for timeout_failure recovery suggestions failed as expected (RED state). Test validates presence of {configured_timeout_minutes} and {actual_runtime_minutes} placeholders in recovery suggestions.",
        "blocked_by": null
      },
      {
        "phase_name": "RED_UNIT",
        "status": "EXECUTED",
        "started_at": "2026-01-28T14:35:00Z",
        "ended_at": "2026-01-28T14:45:00Z",
        "outcome": "PASS",
        "notes": "Created 5 failing unit tests in TestTimeoutFailureDetection class: test_generate_suggestions_for_timeout_failure, test_timeout_failure_suggestions_include_timeout_context, test_timeout_failure_suggestions_include_why_how_action, test_timeout_failure_suggests_optimization, test_timeout_failure_suggests_threshold_adjustment.",
        "blocked_by": null
      },
      {
        "phase_name": "GREEN",
        "status": "EXECUTED",
        "started_at": "2026-01-28T14:45:00Z",
        "ended_at": "2026-01-28T15:15:00Z",
        "outcome": "PASS",
        "notes": "Implemented timeout_failure entry in FAILURE_MODE_TEMPLATES with three distinct suggestion templates following WHY:/HOW:/ACTION: format. Each template provides different perspective: (1) optimization focus, (2) threshold adjustment, (3) profiling and refactoring. All 5 unit tests now passing. Integration with generate_recovery_suggestions method validated. Safe context approach with default fallbacks implemented.",
        "blocked_by": null
      },
      {
        "phase_name": "REVIEW",
        "status": "EXECUTED",
        "started_at": "2026-01-28T15:15:00Z",
        "ended_at": "2026-01-28T15:25:00Z",
        "outcome": "PASS",
        "notes": "Comprehensive self-review completed. SOLID principles verified: Single Responsibility (recovery guidance isolated), Open/Closed (new failure modes added without modification). All acceptance criteria met: WHY clause explains failure mode clearly, HOW clause describes fix mechanism, Actionable element provides specific guidance, suggestions readable and junior-dev appropriate, format consistent. All 26 unit tests passing with >80% coverage.",
        "blocked_by": null
      },
      {
        "phase_name": "REFACTOR_CONTINUOUS",
        "status": "EXECUTED",
        "started_at": "2026-01-28T15:25:00Z",
        "ended_at": "2026-01-28T15:30:00Z",
        "outcome": "PASS",
        "notes": "Level 1-2 readability and complexity analysis completed. Implementation already follows clean code principles: meaningful method naming (generate_recovery_suggestions, format_suggestion), appropriate variable scope with safe_context defaults, proper method extraction. No refactoring required. All tests remain passing (26 unit, 8 acceptance passing).",
        "blocked_by": null
      },
      {
        "phase_name": "REFACTOR_L4",
        "status": "EXECUTED",
        "started_at": "2026-01-28T15:30:00Z",
        "ended_at": "2026-01-28T15:35:00Z",
        "outcome": "PASS",
        "notes": "Level 4 abstraction refinement analysis completed. Template-based suggestion pattern properly abstracted. Parameter objects (safe_context dict with defaults) appropriate. Value objects (template dictionaries) well-structured. Separation of concerns maintained between generation and persistence. No refactoring required. All tests remain passing.",
        "blocked_by": null
      },
      {
        "phase_name": "COMMIT",
        "status": "EXECUTED",
        "started_at": "2026-01-28T15:35:00Z",
        "ended_at": "2026-01-28T15:40:00Z",
        "outcome": "PASS",
        "notes": "Git commit created for task US005-03-01. All 8 TDD phases completed successfully. Timeout_failure implementation complete with 3 suggestion templates, all 26 unit tests passing (100% pass rate), 8 acceptance tests passing, SOLID principles verified, clean code confirmed. Step file execution log updated with phase tracking.",
        "blocked_by": null
      }
    ]
  },
  "validation": {
    "status": "approved",
    "reviewed_by": "devop-orchestrator",
    "reviewed_at": "2026-01-28T22:40:00Z",
    "reviewer_agent": "software-crafter-reviewer",
    "attempt": 1,
    "notes": "Step file structure verified. Schema v2.0 compliant. Ready for execution."
  }
}
