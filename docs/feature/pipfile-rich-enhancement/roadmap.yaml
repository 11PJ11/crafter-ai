# =============================================================================
# ROADMAP: Pipfile Enhancement and Rich Console Integration
# =============================================================================
# Feature: Add rich library for enhanced console output, replace Colors class
# Created: 2026-01-30
# Status: PLANNING
# =============================================================================

metadata:
  feature_id: "PIPFILE-RICH-001"
  title: "Pipfile Enhancement and Rich Console Integration"
  description: |
    Enhance the Pipfile configuration with organized dev-packages and add Rich
    library as a production dependency for enhanced console rendering during
    installation. Replace the manual ANSI Colors class entirely with Rich.

  decisions:
    pdf_library: "fpdf2 (pure Python, no system dependencies)"
    rich_placement: "[packages] (production dependency)"
    colors_class: "REPLACE IMMEDIATELY - full migration to Rich"
    testing_approach: "Functional tests only (mock Rich console)"

  estimated_effort: "2-3 days"
  risk_level: "Medium"

  affected_files:
    pipfile: "Pipfile"
    new_module: "scripts/install/rich_console.py"
    install_utils: "scripts/install/install_utils.py"
    install_nwave: "scripts/install/install_nwave.py"
    uninstall_nwave: "scripts/install/uninstall_nwave.py"
    update_nwave: "scripts/install/update_nwave.py"
    verify_nwave: "scripts/install/verify_nwave.py"
    output_formatter: "scripts/install/output_formatter.py"
    enhanced_backup: "scripts/install/enhanced_backup_system.py"
    tests:
      - "tests/unit/test_output_formatter.py"
      - "tests/unit/test_rich_console.py (NEW)"

# =============================================================================
# PHASE 1: Pipfile Update
# =============================================================================
phase_1:
  name: "Pipfile Update"
  description: |
    Update Pipfile with rich in production packages and reorganize dev-packages
    with logical sections and comments.

  estimated_effort: "30 minutes"
  complexity: "Low"
  risk_level: "Low"
  dependencies: []

  tasks:
    - id: "P1-T1"
      name: "Add rich to production packages"
      description: "Add rich = \"*\" to [packages] section"
      file: "Pipfile"
      change_type: "modify"
      lines_affected: "6-10"

    - id: "P1-T2"
      name: "Replace weasyprint with fpdf2"
      description: "Use fpdf2 instead of weasyprint (pure Python, no system deps)"
      file: "Pipfile"
      change_type: "modify"
      notes: "fpdf2 has no external system dependencies unlike WeasyPrint"

    - id: "P1-T3"
      name: "Reorganize dev-packages with sections"
      description: |
        Organize dev-packages into logical sections with comments:
        - Testing: mutmut, pytest, pytest-bdd, pytest-describe-it, pytest-html,
                   pytest-cov, pytest-pspec, pytest-mock, pytest-describe, pytest-watch
        - Code Quality: ruff, mypy
        - Security: bandit[toml], detect-secrets
        - Git & Release: python-semantic-release, commitizen, pre-commit
        - Reporting: fpdf2
        - CLI Utilities: click, colorama, tqdm
      file: "Pipfile"
      change_type: "modify"
      lines_affected: "11-35"

    - id: "P1-T4"
      name: "Run pipenv lock"
      description: "Update Pipfile.lock with new dependencies"
      command: "pipenv lock"
      validation: "pipenv lock completes without errors"

    - id: "P1-T5"
      name: "Verify no dependency conflicts"
      description: "Check dependency graph for conflicts"
      command: "pipenv graph"
      validation: "No circular dependencies or version conflicts"

  acceptance_criteria:
    - "rich = \"*\" present in [packages] section"
    - "fpdf2 = \"*\" present in [dev-packages] (not weasyprint)"
    - "All new testing packages present in [dev-packages]"
    - "bandit = {extras = [\"toml\"], version = \"*\"} format used"
    - "pipenv lock succeeds without conflicts"
    - "pipenv install --dev succeeds"
    - "All existing tests pass"

  deliverables:
    - file: "Pipfile"
      description: "Updated with rich and organized dev-packages"
    - file: "Pipfile.lock"
      description: "Updated lock file with all dependencies resolved"

  commit_message: |
    chore(deps): add rich to production packages and reorganize dev-packages

    - Add rich = "*" to [packages] for enhanced console rendering
    - Add testing packages: mutmut, pytest-describe-it, pytest-html, etc.
    - Add security packages: bandit[toml], detect-secrets
    - Add release packages: python-semantic-release, commitizen
    - Add reporting: fpdf2 (pure Python PDF, replaces WeasyPrint)
    - Organize dev-packages with section comments for maintainability

# =============================================================================
# PHASE 2: Rich Console Module + Colors Replacement
# =============================================================================
phase_2:
  name: "Rich Console Module + Colors Replacement"
  description: |
    Create the rich_console.py module with RichLogger and ConsoleFactory,
    then remove the Colors class entirely from install_utils.py and migrate
    the Logger class to use Rich.

  estimated_effort: "3-4 hours"
  complexity: "Medium"
  risk_level: "Medium"
  dependencies:
    - "phase_1"

  tasks:
    - id: "P2-T1"
      name: "Create rich_console.py module"
      description: |
        Create new module with:
        - RichLogger class (Logger-compatible API using rich.console.Console)
        - ConsoleFactory for context-aware logger selection
        - Graceful fallback when rich is not available
      file: "scripts/install/rich_console.py"
      change_type: "create"
      estimated_lines: "150-200"

      implementation_notes: |
        RichLogger should provide:
        - info(message) -> rich green text
        - warn(message) -> rich yellow text
        - error(message) -> rich red text
        - step(message) -> rich blue text with spinner option
        - progress_spinner(message) -> context manager for spinners
        - table(headers, rows) -> rich table output
        - panel(title, content) -> rich panel for summaries

        ConsoleFactory.create_logger() should:
        - Check context_detector.is_claude_code_context() -> return silent Logger
        - Check context_detector.is_ci_environment() -> return plain Logger
        - Otherwise -> return RichLogger

        Fallback behavior:
        - If rich import fails, return standard Logger with ANSI colors
        - If stdout is not TTY, disable rich features

    - id: "P2-T2"
      name: "Remove Colors class from install_utils.py"
      description: |
        Delete the Colors class (lines 20-38) entirely.
        This removes:
        - Colors class definition
        - Colors.strip_on_windows() method
        - Colors.strip_on_windows() initialization call
      file: "scripts/install/install_utils.py"
      change_type: "modify"
      lines_to_remove: "19-38"

    - id: "P2-T3"
      name: "Migrate Logger class to use Rich"
      description: |
        Update Logger class in install_utils.py to:
        - Import from rich_console module
        - Use RichLogger internally when appropriate
        - Maintain backward-compatible API

        The Logger class should:
        - Accept optional use_rich=True parameter
        - Delegate to RichLogger when use_rich=True and rich available
        - Fall back to plain text when use_rich=False or rich unavailable
      file: "scripts/install/install_utils.py"
      change_type: "modify"
      lines_affected: "41-91"

    - id: "P2-T4"
      name: "Update install_nwave.py Colors imports"
      description: |
        Replace all Colors.* usages with rich_console equivalents.
        Affected lines with Colors usage:
        - Line 537: Colors.GREEN in validation message
        - Line 548: Colors.RED in validation failure
        - Line 568-726: Colors in help text and success messages
      file: "scripts/install/install_nwave.py"
      change_type: "modify"
      colors_usages:
        - line: 537
          current: "Colors.GREEN"
          replacement: "RichLogger style or rich markup"
        - line: 548
          current: "Colors.RED"
          replacement: "RichLogger style or rich markup"
        - lines: "568-726"
          current: "Colors.BLUE, Colors.NC in help text"
          replacement: "Rich Console print with markup"

    - id: "P2-T5"
      name: "Update verify_nwave.py Colors imports"
      description: |
        Replace all Colors.* usages:
        - Line 46: Import statement
        - Lines 108-133: format_terminal_output function
      file: "scripts/install/verify_nwave.py"
      change_type: "modify"
      colors_usages:
        - line: 46
          current: "from scripts.install.install_utils import Colors"
          replacement: "from scripts.install.rich_console import RichLogger"
        - lines: "108-133"
          current: "Colors.GREEN, Colors.RED, Colors.YELLOW"
          replacement: "Rich markup or RichLogger methods"

    - id: "P2-T6"
      name: "Update uninstall_nwave.py Colors imports"
      description: |
        Replace all Colors.* usages (standalone script uses local import):
        - Line 17: Import Colors from install_utils
        - Lines 92-94, 106-128, 276-281, 304-334, 378-415: Colors usage
      file: "scripts/install/uninstall_nwave.py"
      change_type: "modify"
      note: "Uses local import (from install_utils import Colors)"

    - id: "P2-T7"
      name: "Update update_nwave.py Colors imports"
      description: |
        Replace all Colors.* usages (standalone script uses local import):
        - Line 18: Import Colors from install_utils
        - Lines 126, 385-410, 433-476, 509-560: Colors usage
      file: "scripts/install/update_nwave.py"
      change_type: "modify"
      note: "Uses local import (from install_utils import Colors)"

    - id: "P2-T8"
      name: "Update enhanced_backup_system.py Colors imports"
      description: |
        Replace all Colors.* usages:
        - Line 19: Import Colors from install_utils
        - Lines 519-534: Colors in help text
      file: "scripts/install/enhanced_backup_system.py"
      change_type: "modify"

    - id: "P2-T9"
      name: "Update output_formatter.py Colors imports"
      description: |
        Replace Colors class usage with Rich:
        - Line 45: Import Colors from install_utils
        - Lines 67-78, 102-104: TerminalFormatter._color() method

        TerminalFormatter should be refactored to:
        - Use rich.text.Text or rich markup for styling
        - Maintain use_colors parameter for backward compatibility
      file: "scripts/install/output_formatter.py"
      change_type: "modify"

  acceptance_criteria:
    - "rich_console.py module exists with RichLogger and ConsoleFactory"
    - "Colors class completely removed from install_utils.py"
    - "No 'Colors' string appears in any scripts/install/*.py file"
    - "No 'from.*Colors' import statement in codebase"
    - "All install scripts function correctly"
    - "Installation output shows rich formatting (spinners, colors, etc.)"
    - "CI environment shows plain text output"
    - "Claude Code context shows JSON output (existing behavior preserved)"
    - "All existing tests pass (some may need updates)"

  deliverables:
    - file: "scripts/install/rich_console.py"
      description: "New module with RichLogger and ConsoleFactory"
    - file: "scripts/install/install_utils.py"
      description: "Colors class removed, Logger updated"
    - file: "scripts/install/install_nwave.py"
      description: "Migrated to use Rich"
    - file: "scripts/install/verify_nwave.py"
      description: "Migrated to use Rich"
    - file: "scripts/install/uninstall_nwave.py"
      description: "Migrated to use Rich"
    - file: "scripts/install/update_nwave.py"
      description: "Migrated to use Rich"
    - file: "scripts/install/enhanced_backup_system.py"
      description: "Migrated to use Rich"
    - file: "scripts/install/output_formatter.py"
      description: "TerminalFormatter uses Rich"

  commit_message: |
    feat(install): replace Colors class with Rich console library

    - Create rich_console.py with RichLogger and ConsoleFactory
    - Remove Colors class entirely from install_utils.py
    - Migrate Logger class to use Rich when available
    - Update all install scripts to use Rich formatting
    - Maintain backward compatibility with CI and Claude Code contexts

    BREAKING CHANGE: Colors class removed from install_utils.py
    Migration: Use RichLogger from rich_console.py or rich markup directly

# =============================================================================
# PHASE 3: Install Script Integration
# =============================================================================
phase_3:
  name: "Install Script Integration"
  description: |
    Enhance the installation scripts with rich visual feedback including
    progress spinners, status panels, and validation result tables.

  estimated_effort: "2-3 hours"
  complexity: "Medium"
  risk_level: "Low"
  dependencies:
    - "phase_2"

  tasks:
    - id: "P3-T1"
      name: "Add progress spinners to install_nwave.py"
      description: |
        Add rich spinners for long-running operations:
        - Building IDE bundle (line 93)
        - Running source embedding (line 70)
        - Installing framework files (line 279)
        - Validating installation (line 499)
      file: "scripts/install/install_nwave.py"
      change_type: "modify"

      spinner_locations:
        - method: "run_embedding"
          message: "Running source embedding..."
        - method: "build_framework"
          message: "Building IDE bundle..."
        - method: "install_framework"
          message: "Installing framework..."
        - method: "validate_installation"
          message: "Validating installation..."

    - id: "P3-T2"
      name: "Add installation summary panel"
      description: |
        Add a rich panel showing installation summary at end of successful install.
        Should display:
        - Framework version
        - Installation location
        - Agent count
        - Command count
        - Available commands
      file: "scripts/install/install_nwave.py"
      change_type: "modify"
      location: "lines 689-726 (success message section)"

    - id: "P3-T3"
      name: "Add validation results table"
      description: |
        Replace text-based validation output with rich table:
        | Component | Status | Count |
        |-----------|--------|-------|
        | Agents    | OK     | 41    |
        | Commands  | OK     | 12    |
        | Templates | OK     | 3     |
        | Manifest  | OK     | Yes   |
      file: "scripts/install/install_nwave.py"
      change_type: "modify"
      location: "validate_installation method"

    - id: "P3-T4"
      name: "Add rich title panel on startup"
      description: |
        Display a styled title panel when installer starts:
        - nWave Framework Installation Script
        - Version number
        - Dry-run indicator if applicable
      file: "scripts/install/install_nwave.py"
      change_type: "modify"
      location: "main() function start"

    - id: "P3-T5"
      name: "Add progress spinners to update_nwave.py"
      description: "Add spinners for build, uninstall, install phases"
      file: "scripts/install/update_nwave.py"
      change_type: "modify"

    - id: "P3-T6"
      name: "Add progress indication to uninstall_nwave.py"
      description: "Add spinners and confirmation panels"
      file: "scripts/install/uninstall_nwave.py"
      change_type: "modify"

  acceptance_criteria:
    - "Installation shows spinner during long operations"
    - "Spinners stop and show checkmark on success"
    - "Spinners stop and show X on failure"
    - "Installation summary displays in styled panel"
    - "Validation results display in table format"
    - "Title panel appears at script start"
    - "All spinners gracefully degrade in CI/non-TTY"
    - "Existing functionality unchanged"

  deliverables:
    - file: "scripts/install/install_nwave.py"
      description: "Enhanced with rich spinners, panels, tables"
    - file: "scripts/install/update_nwave.py"
      description: "Enhanced with rich progress indication"
    - file: "scripts/install/uninstall_nwave.py"
      description: "Enhanced with rich progress indication"

  commit_message: |
    feat(install): add rich progress spinners, panels, and tables

    - Add spinners for long-running operations (build, install, validate)
    - Add styled title panel at script startup
    - Add installation summary panel on success
    - Add table view for validation results
    - Graceful degradation for CI and non-TTY environments

# =============================================================================
# PHASE 4: Output Formatter Enhancement
# =============================================================================
phase_4:
  name: "Output Formatter Enhancement"
  description: |
    Update the TerminalFormatter class to use Rich panels for error display
    while maintaining the [ERROR]/[FIX]/[THEN] structure.

  estimated_effort: "1-2 hours"
  complexity: "Low"
  risk_level: "Low"
  dependencies:
    - "phase_2"

  tasks:
    - id: "P4-T1"
      name: "Update TerminalFormatter to use Rich panels"
      description: |
        Refactor TerminalFormatter.format_terminal_error() to:
        - Use rich.panel.Panel for error display
        - Maintain [ERROR]/[FIX]/[THEN] structure
        - Apply rich styling instead of raw ANSI codes

        Example output:
        +------------------------------------------+
        | [ERROR] No virtual environment detected  |
        |                                          |
        | [FIX] Run 'pipenv shell' to activate     |
        |                                          |
        | [THEN] Re-run the installer script       |
        +------------------------------------------+
      file: "scripts/install/output_formatter.py"
      change_type: "modify"

    - id: "P4-T2"
      name: "Remove _color helper method"
      description: |
        Remove TerminalFormatter._color() method since Rich handles styling.
        The method currently wraps text in ANSI codes - Rich makes this obsolete.
      file: "scripts/install/output_formatter.py"
      change_type: "modify"
      lines_to_remove: "67-79"

    - id: "P4-T3"
      name: "Add rich panel for preflight errors"
      description: |
        When preflight checks fail, display errors in a styled panel
        with clear visual hierarchy.
      file: "scripts/install/output_formatter.py"
      change_type: "modify"

    - id: "P4-T4"
      name: "Maintain JSON output unchanged"
      description: |
        Verify ClaudeCodeFormatter remains unchanged.
        JSON output for Claude Code context should not include Rich formatting.
      file: "scripts/install/output_formatter.py"
      change_type: "verify"
      expected: "No changes to ClaudeCodeFormatter class"

  acceptance_criteria:
    - "TerminalFormatter uses rich.panel.Panel for errors"
    - "[ERROR]/[FIX]/[THEN] structure preserved"
    - "Error panels have visible borders"
    - "Colors match error severity (red for error, yellow for fix, green for then)"
    - "JSON output (ClaudeCodeFormatter) unchanged"
    - "CI output (CIFormatter) unchanged"
    - "use_colors=False disables rich formatting gracefully"

  deliverables:
    - file: "scripts/install/output_formatter.py"
      description: "TerminalFormatter uses Rich panels"

  commit_message: |
    feat(install): use Rich panels for terminal error formatting

    - Refactor TerminalFormatter to use rich.panel.Panel
    - Maintain [ERROR]/[FIX]/[THEN] structure with visual styling
    - Remove manual ANSI color handling (_color method)
    - Preserve JSON and CI output formats unchanged

# =============================================================================
# PHASE 5: Tests and Documentation
# =============================================================================
phase_5:
  name: "Tests and Documentation"
  description: |
    Add functional tests for RichLogger, update existing tests that reference
    Colors class, and update documentation.

  estimated_effort: "2-3 hours"
  complexity: "Medium"
  risk_level: "Low"
  dependencies:
    - "phase_2"
    - "phase_3"
    - "phase_4"

  tasks:
    - id: "P5-T1"
      name: "Create test_rich_console.py"
      description: |
        Create comprehensive unit tests for rich_console.py:
        - Test RichLogger.info/warn/error/step methods
        - Test ConsoleFactory context detection
        - Test graceful fallback when rich unavailable
        - Test silent mode behavior
        - Mock rich.console.Console for all tests
      file: "tests/unit/test_rich_console.py"
      change_type: "create"

      test_cases:
        - name: "test_rich_logger_info_outputs_message"
          description: "Verify info() outputs message with green styling"
        - name: "test_rich_logger_warn_outputs_message"
          description: "Verify warn() outputs message with yellow styling"
        - name: "test_rich_logger_error_outputs_message"
          description: "Verify error() outputs message with red styling"
        - name: "test_rich_logger_step_outputs_message"
          description: "Verify step() outputs message with blue styling"
        - name: "test_rich_logger_silent_mode_suppresses_output"
          description: "Verify silent=True suppresses console output"
        - name: "test_rich_logger_logs_to_file"
          description: "Verify messages written to log file"
        - name: "test_console_factory_returns_rich_for_terminal"
          description: "Verify factory returns RichLogger for interactive terminal"
        - name: "test_console_factory_returns_plain_for_ci"
          description: "Verify factory returns plain Logger for CI environment"
        - name: "test_console_factory_returns_silent_for_claude"
          description: "Verify factory returns silent Logger for Claude Code"
        - name: "test_rich_logger_fallback_when_rich_unavailable"
          description: "Verify graceful fallback if rich import fails"

    - id: "P5-T2"
      name: "Update test_output_formatter.py"
      description: |
        Update tests that mock Colors class:
        - Line 87: patch("scripts.install.output_formatter.Colors")

        Change to mock rich.console.Console instead.
        Update assertions to verify rich styling.
      file: "tests/unit/test_output_formatter.py"
      change_type: "modify"

    - id: "P5-T3"
      name: "Update test_install_nwave_preflight.py"
      description: |
        Verify tests still pass after Colors removal.
        Update any mocks that reference Colors.
      file: "tests/unit/test_install_nwave_preflight.py"
      change_type: "verify"

    - id: "P5-T4"
      name: "Run full test suite"
      description: |
        Execute complete test suite to ensure no regressions:
        - Unit tests
        - Integration tests
        - Acceptance tests (if any)
      command: "pipenv run pytest tests/ -v"
      validation: "All tests pass"

    - id: "P5-T5"
      name: "Update feature documentation"
      description: |
        Create/update documentation:
        - Document RichLogger API
        - Document ConsoleFactory usage
        - Document migration from Colors class
      file: "docs/feature/pipfile-rich-enhancement/README.md"
      change_type: "create"

    - id: "P5-T6"
      name: "Verify CI compatibility"
      description: |
        Ensure CI pipelines still work:
        - GitHub Actions workflows pass
        - No visual output issues in CI logs
        - Exit codes correct
      validation: "CI pipeline passes on feature branch"

  acceptance_criteria:
    - "test_rich_console.py exists with 10+ test cases"
    - "All existing tests pass (no regressions)"
    - "test_output_formatter.py updated to not reference Colors"
    - "CI pipeline passes"
    - "No 'Colors' references in test files"
    - "Documentation explains RichLogger usage"

  deliverables:
    - file: "tests/unit/test_rich_console.py"
      description: "New test file for rich_console module"
    - file: "tests/unit/test_output_formatter.py"
      description: "Updated tests without Colors references"
    - file: "docs/feature/pipfile-rich-enhancement/README.md"
      description: "Feature documentation"

  commit_message: |
    test(install): add functional tests for RichLogger and update Colors tests

    - Add test_rich_console.py with comprehensive RichLogger tests
    - Update test_output_formatter.py to mock Rich instead of Colors
    - Verify all existing tests pass
    - Add feature documentation

# =============================================================================
# SUMMARY: Implementation Order
# =============================================================================
implementation_order:
  - phase: "phase_1"
    description: "Pipfile Update"
    blocking: false
    can_parallel_with: []

  - phase: "phase_2"
    description: "Rich Console Module + Colors Replacement"
    blocking: true
    depends_on: ["phase_1"]
    note: "This is the core migration - must be complete before phases 3-4"

  - phase: "phase_3"
    description: "Install Script Integration"
    blocking: false
    depends_on: ["phase_2"]
    can_parallel_with: ["phase_4"]

  - phase: "phase_4"
    description: "Output Formatter Enhancement"
    blocking: false
    depends_on: ["phase_2"]
    can_parallel_with: ["phase_3"]

  - phase: "phase_5"
    description: "Tests and Documentation"
    blocking: false
    depends_on: ["phase_2", "phase_3", "phase_4"]

# =============================================================================
# RISK ASSESSMENT
# =============================================================================
risks:
  - id: "RISK-001"
    title: "Breaking change for Colors class users"
    severity: "Medium"
    probability: "Low"
    impact: |
      Any external code importing Colors from install_utils will break.
    mitigation: |
      - Document breaking change in commit message
      - Colors class is internal to install scripts, not public API
      - No external users expected

  - id: "RISK-002"
    title: "Rich rendering issues in some terminals"
    severity: "Low"
    probability: "Low"
    impact: |
      Some terminals may not render Rich output correctly.
    mitigation: |
      - Rich has built-in terminal detection and fallback
      - ConsoleFactory uses context detection to disable rich in CI
      - Test on multiple terminal emulators

  - id: "RISK-003"
    title: "CI output changes may affect log parsing"
    severity: "Low"
    probability: "Very Low"
    impact: |
      If CI pipelines parse installer output, format changes may break parsing.
    mitigation: |
      - CIFormatter remains unchanged (plain text)
      - is_ci_environment() detection prevents rich output in CI
      - Exit codes unchanged

  - id: "RISK-004"
    title: "Test mocking complexity"
    severity: "Low"
    probability: "Medium"
    impact: |
      Mocking rich.console.Console may be more complex than mocking Colors.
    mitigation: |
      - Use functional tests that verify output content, not styling
      - Mock at ConsoleFactory level to return test logger
      - Focus on behavior, not implementation details

# =============================================================================
# VALIDATION CHECKLIST
# =============================================================================
final_validation:
  pre_merge_checks:
    - "All phases completed"
    - "All tests pass (pipenv run pytest tests/ -v)"
    - "Linting passes (pipenv run lint)"
    - "Type checking passes (pipenv run mypy scripts/install/)"
    - "Manual testing: run install_nwave.py in terminal"
    - "Manual testing: run install_nwave.py --dry-run"
    - "CI pipeline passes"
    - "No 'Colors' string in scripts/install/*.py"
    - "No 'from.*Colors' imports in codebase"
    - "Rich formatting visible in interactive terminal"
    - "Plain text output in CI environment"

  regression_checks:
    - "Install script completes successfully"
    - "Uninstall script completes successfully"
    - "Update script completes successfully"
    - "Verify script completes successfully"
    - "Preflight checks display errors correctly"
    - "Backup system works correctly"
    - "--help output renders correctly"
    - "--dry-run mode works correctly"
