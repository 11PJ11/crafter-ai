{
  "step_id": "02-01",
  "name": "Define GitHubAPIPort interface",
  "description": "HTTP calls to GitHub API for release metadata. Get latest release version and checksum, handle rate limiting and network errors.",
  "type": "port_interface",
  "phase": "02",
  "phase_name": "Port Interface Definitions",
  "components": [
    {
      "name": "GitHubAPIPort",
      "type": "port_interface",
      "location": "nWave/core/versioning/ports/github_api_port.py"
    }
  ],
  "dependencies": ["01-01"],
  "acceptance_criteria": "Abstract method get_latest_release() defined; Return type includes version, checksum, download_url; NetworkError and RateLimitError exception types defined",
  "tdd_cycle": {
    "acceptance_test": {
      "scenario_name": "NOT_APPLICABLE",
      "test_file": "tests/unit/ports/test_github_api_port.py",
      "test_file_format": "py_pytest",
      "scenario_index": 0,
      "initially_ignored": false,
      "is_walking_skeleton": false,
      "mapped_scenario": {
        "scenario_function": "",
        "scenario_description": "Port interface definition - no acceptance scenario, interface contract tests only",
        "mapping_type": "infrastructure",
        "notes": "Port interfaces define contracts, tested via contract tests and adapter integration"
      }
    },
    "expected_unit_tests": [
      "test_github_api_port_is_abstract",
      "test_get_latest_release_method_defined",
      "test_return_type_includes_version",
      "test_return_type_includes_checksum",
      "test_return_type_includes_download_url",
      "test_network_error_exception_defined",
      "test_rate_limit_error_exception_defined"
    ],
    "mock_boundaries": {
      "allowed_ports": ["GitHubAPIPort"],
      "forbidden_domain_classes": ["Version"],
      "in_memory_adapters": []
    },
    "tdd_phase_tracking": {
      "current_phase": "COMPLETED",
      "active_e2e_test": "",
      "inactive_e2e_tests": "N/A - port interface step",
      "phases_completed": ["PREPARE", "RED_ACCEPTANCE", "RED_UNIT", "GREEN", "REVIEW", "REFACTOR_CONTINUOUS", "REFACTOR_L4", "COMMIT"],
      "test_results": {
        "total": 19,
        "passed": 19,
        "failed": 0,
        "skipped": 0
      }
    },
    "phase_execution_log": [
      {
        "phase_name": "PREPARE",
        "status": "SKIPPED",
        "started_at": "2026-01-28T23:30:00Z",
        "ended_at": "2026-01-28T23:30:00Z",
        "outcome": "NOT_APPLICABLE",
        "notes": "NOT_APPLICABLE: Port interface - no acceptance test to prepare. Created directory structure for ports.",
        "blocked_by": "NOT_APPLICABLE: Port interface step"
      },
      {
        "phase_name": "RED_ACCEPTANCE",
        "status": "SKIPPED",
        "started_at": "2026-01-28T23:30:00Z",
        "ended_at": "2026-01-28T23:30:00Z",
        "outcome": "NOT_APPLICABLE",
        "notes": "NOT_APPLICABLE: Port interface - no acceptance test",
        "blocked_by": "NOT_APPLICABLE: Port interface step"
      },
      {
        "phase_name": "RED_UNIT",
        "status": "EXECUTED",
        "started_at": "2026-01-28T23:30:00Z",
        "ended_at": "2026-01-28T23:35:00Z",
        "outcome": "RED_CONFIRMED",
        "notes": "Wrote 19 contract tests in 7 test classes. All tests fail with ModuleNotFoundError - GitHubAPIPort module does not exist.",
        "blocked_by": null,
        "artifacts": ["tests/unit/ports/test_github_api_port.py"],
        "test_classes": [
          "TestGitHubApiPortIsAbstract (2 tests)",
          "TestGetLatestReleaseMethodDefined (3 tests)",
          "TestReturnTypeIncludesVersion (3 tests)",
          "TestReturnTypeIncludesChecksum (2 tests)",
          "TestReturnTypeIncludesDownloadUrl (2 tests)",
          "TestNetworkErrorExceptionDefined (3 tests)",
          "TestRateLimitErrorExceptionDefined (4 tests)"
        ]
      },
      {
        "phase_name": "GREEN",
        "status": "EXECUTED",
        "started_at": "2026-01-28T23:35:00Z",
        "ended_at": "2026-01-28T23:40:00Z",
        "outcome": "ALL_TESTS_PASS",
        "notes": "Implemented GitHubAPIPort abstract class with get_latest_release method, ReleaseInfo dataclass, NetworkError and RateLimitError exceptions. All 19 tests pass.",
        "blocked_by": null,
        "artifacts": ["nWave/core/versioning/ports/github_api_port.py"],
        "implementation_details": {
          "pattern": "Port Interface (Hexagonal Architecture)",
          "classes": ["GitHubAPIPort", "ReleaseInfo", "NetworkError", "RateLimitError"],
          "lines_of_code": 126
        }
      },
      {
        "phase_name": "REVIEW",
        "status": "EXECUTED",
        "started_at": "2026-01-28T23:40:00Z",
        "ended_at": "2026-01-28T23:42:00Z",
        "outcome": "APPROVED",
        "notes": "All acceptance criteria met: abstract method defined, return type includes version/checksum/download_url, exception types defined. Business-focused naming, comprehensive docstrings, type hints throughout.",
        "blocked_by": null,
        "review_findings": {
          "business_language": "PASS",
          "no_mocks_inside_hexagon": "PASS",
          "test_coverage": "PASS",
          "compose_method": "PASS",
          "issues_found": 0
        }
      },
      {
        "phase_name": "REFACTOR_CONTINUOUS",
        "status": "EXECUTED",
        "started_at": "2026-01-28T23:42:00Z",
        "ended_at": "2026-01-28T23:43:00Z",
        "outcome": "NO_CHANGES_NEEDED",
        "notes": "L1 (Naming): Clear business-focused names. L2 (Complexity): Methods are simple. L3 (Organization): Well-structured. No refactoring required.",
        "blocked_by": null,
        "refactoring_levels": {
          "L1_naming": "PASS - No changes needed",
          "L2_complexity": "PASS - No changes needed",
          "L3_organization": "PASS - No changes needed"
        }
      },
      {
        "phase_name": "REFACTOR_L4",
        "status": "SKIPPED",
        "started_at": "2026-01-28T23:43:00Z",
        "ended_at": "2026-01-28T23:43:00Z",
        "outcome": "NOT_APPLICABLE",
        "notes": "NOT_APPLICABLE: GitHubAPIPort uses correct architectural patterns (ABC for port, frozen dataclass for ReleaseInfo, custom exceptions for error types).",
        "blocked_by": "NOT_APPLICABLE: Pattern already appropriate"
      },
      {
        "phase_name": "COMMIT",
        "status": "EXECUTED",
        "started_at": "2026-01-28T23:43:00Z",
        "ended_at": "2026-01-28T23:45:00Z",
        "outcome": "COMMITTED",
        "notes": "Committed GitHubAPIPort interface definition with all tests passing.",
        "blocked_by": null
      }
    ]
  },
  "quality_gates": {
    "acceptance_test_must_fail_first": false,
    "unit_tests_must_fail_first": true,
    "no_mocks_inside_hexagon": true,
    "business_language_required": true,
    "refactor_level": 4,
    "in_memory_test_ratio_target": 1.0,
    "validation_after_each_phase": true,
    "all_8_phases_mandatory": true,
    "phase_documentation_required": true
  },
  "review_validation": {
    "reviewed_by": "software-crafter-reviewer",
    "reviewed_at": "2026-01-28T11:15:00Z",
    "schema_version": "2.0",
    "status": "APPROVED",
    "checks": {
      "8_phase_structure": {
        "status": "PASS",
        "details": "All 8 phases present: PREPARE, RED_ACCEPTANCE, RED_UNIT, GREEN, REVIEW, REFACTOR_CONTINUOUS, REFACTOR_L4, COMMIT"
      },
      "tdd_cycle_complete": {
        "status": "PASS",
        "details": "acceptance_test, expected_unit_tests (7 tests), mock_boundaries, phase_tracking all defined"
      },
      "self_contained": {
        "status": "PASS",
        "details": "Step has clear description, components, acceptance criteria, and test expectations"
      },
      "dependencies_valid": {
        "status": "PASS",
        "details": "Dependency 01-01 (Version entity) exists and is APPROVED. Required for return type specification."
      },
      "acceptance_criteria_testable": {
        "status": "PASS",
        "details": "Abstract method definition, return type structure (version, checksum, download_url), and exception types (NetworkError, RateLimitError) are all testable"
      },
      "port_interface_adaptations": {
        "status": "PASS",
        "details": "Correctly configured: mapping_type=infrastructure, acceptance_test_must_fail_first=false, contract tests expected"
      },
      "mock_boundaries_appropriate": {
        "status": "PASS",
        "details": "GitHubAPIPort in allowed_ports (can be mocked when used). Version in forbidden_domain_classes (no mocking domain entities)."
      }
    },
    "observations": [
      {
        "severity": "INFO",
        "message": "PREPARE and RED_ACCEPTANCE phases marked NOT_APPLICABLE in notes - correct for port interface step",
        "recommendation": "During execution, set status to SKIPPED with blocked_by using 'NOT_APPLICABLE: Port interface' prefix"
      }
    ],
    "approval_notes": "Step is well-structured for port interface TDD. Clear acceptance criteria covering method signature, return types, and exception types. Unit test names align with acceptance criteria. Dependency on 01-01 (Version entity) is logically correct for return type specification. Ready for execution."
  },
  "execution_summary": {
    "executed_by": "software-crafter",
    "executed_at": "2026-01-28T23:45:00Z",
    "status": "COMPLETED",
    "total_tests": 19,
    "tests_passed": 19,
    "tests_failed": 0,
    "files_created": [
      "nWave/core/versioning/ports/github_api_port.py",
      "tests/unit/ports/test_github_api_port.py",
      "nWave/core/versioning/ports/__init__.py",
      "tests/unit/ports/__init__.py"
    ],
    "acceptance_criteria_validation": {
      "abstract_method_defined": "PASS - get_latest_release() is @abstractmethod",
      "return_type_includes_version": "PASS - ReleaseInfo.version: Version",
      "return_type_includes_checksum": "PASS - ReleaseInfo.checksum: str",
      "return_type_includes_download_url": "PASS - ReleaseInfo.download_url: str",
      "network_error_exception": "PASS - NetworkError(Exception) defined",
      "rate_limit_error_exception": "PASS - RateLimitError(Exception) with retry_after defined"
    }
  }
}
