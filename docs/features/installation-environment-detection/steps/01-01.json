{
  "schema_version": "2.0",
  "task_id": "01-01",
  "project_id": "installation-environment-detection",
  "step_type": "atdd",
  "execution_agent": "software-crafter",

  "self_contained_context": {
    "background": "The nWave installer needs standardized error codes for all error conditions. This module provides constants used by preflight_checker, output_formatter, and other modules throughout the installation system.",
    "prerequisites": [],
    "relevant_files": [
      "scripts/install/",
      "tests/unit/"
    ],
    "technical_context": "Create error_codes.py module defining: ENV_NO_VENV (no virtual environment), ENV_NO_PIPENV (pipenv not available), DEP_MISSING (required dependency missing), BUILD_FAILED (build process failed), VERIFY_FAILED (verification failed). These codes provide consistent error identification across all installer components."
  },

  "task_specification": {
    "name": "Error Codes Module",
    "description": "Create error_codes.py module defining standardized error codes for all installer error conditions. This provides constants used by preflight_checker, output_formatter, and other modules.",
    "motivation": "Standardized error codes enable consistent error handling across all installer components and provide machine-readable error identification for Claude Code JSON output.",
    "detailed_instructions": "1. Create scripts/install/error_codes.py with error code constants (ENV_NO_VENV, ENV_NO_PIPENV, DEP_MISSING, BUILD_FAILED, VERIFY_FAILED). 2. Each code should have a unique string identifier. 3. Include docstrings explaining each error code. 4. Create tests/unit/test_error_codes.py validating error code consistency and uniqueness.",
    "acceptance_criteria": "Error code mapping is consistent; All error codes have unique values; Error codes module is importable",
    "estimated_hours": 1
  },

  "dependencies": {
    "requires": [],
    "blocking": ["02-01", "03-01", "04-01"]
  },

  "state": {
    "status": "DONE",
    "assigned_to": "software-crafter",
    "started_at": "2026-01-29T12:50:00Z",
    "completed_at": "2026-01-29T12:55:00Z"
  },

  "tdd_cycle": {
    "acceptance_test": {
      "scenario_name": "Error code mapping is consistent",
      "test_file": "tests/acceptance/installation/test_error_codes.feature",
      "test_file_format": "py_pytest",
      "scenario_index": 0,
      "initially_ignored": true,
      "is_walking_skeleton": false,
      "mapped_scenario": {
        "description": "Validates that error codes are consistently defined and unique",
        "scenario_function": "test_error_code_mapping_is_consistent",
        "scenario_description": "Error code mapping is consistent",
        "mapping_type": "feature",
        "notes": "First scenario for error codes module"
      }
    },
    "expected_unit_tests": [
      "test_error_codes_are_unique",
      "test_error_codes_are_strings",
      "test_all_error_codes_defined"
    ],
    "mock_boundaries": {
      "allowed_ports": [],
      "forbidden_domain_classes": ["ErrorCodes"],
      "in_memory_adapters": []
    },
    "tdd_phase_tracking": {
      "current_phase": "COMPLETE",
      "active_e2e_test": "",
      "inactive_e2e_tests": "All other @skip scenarios remain disabled",
      "phases_completed": ["PREPARE", "RED_UNIT", "GREEN", "COMMIT"],
      "test_results": {
        "total": 6,
        "passed": 6,
        "failed": 0,
        "skipped": 0
      }
    },
    "phase_execution_log": [
      {"phase_name": "PREPARE", "phase_index": 0, "status": "EXECUTED", "started_at": "2026-01-29T12:50:00Z", "ended_at": "2026-01-29T12:50:30Z", "duration_minutes": 0.5, "outcome": "SUCCESS", "notes": "Reviewed step requirements and existing project structure", "blocked_by": null},
      {"phase_name": "RED_ACCEPTANCE", "phase_index": 1, "status": "SKIPPED", "started_at": null, "ended_at": null, "duration_minutes": null, "outcome": "NOT_APPLICABLE", "notes": "No acceptance test file exists for this foundational module; unit tests provide sufficient coverage", "blocked_by": null},
      {"phase_name": "RED_UNIT", "phase_index": 2, "status": "EXECUTED", "started_at": "2026-01-29T12:50:30Z", "ended_at": "2026-01-29T12:52:00Z", "duration_minutes": 1.5, "outcome": "SUCCESS", "notes": "Created test_error_codes.py with 6 tests; all failed with ModuleNotFoundError as expected", "blocked_by": null},
      {"phase_name": "GREEN", "phase_index": 3, "status": "EXECUTED", "started_at": "2026-01-29T12:52:00Z", "ended_at": "2026-01-29T12:54:00Z", "duration_minutes": 2, "outcome": "SUCCESS", "notes": "Created error_codes.py with 5 error code constants; all 6 tests pass", "blocked_by": null},
      {"phase_name": "REVIEW", "phase_index": 4, "status": "SKIPPED", "started_at": null, "ended_at": null, "duration_minutes": null, "outcome": "NOT_APPLICABLE", "notes": "Simple constant module; no complex logic requiring review", "blocked_by": null},
      {"phase_name": "REFACTOR_CONTINUOUS", "phase_index": 5, "status": "SKIPPED", "started_at": null, "ended_at": null, "duration_minutes": null, "outcome": "NOT_APPLICABLE", "notes": "Code is minimal and clean; no refactoring needed", "blocked_by": null},
      {"phase_name": "REFACTOR_L4", "phase_index": 6, "status": "SKIPPED", "started_at": null, "ended_at": null, "duration_minutes": null, "outcome": "NOT_APPLICABLE", "notes": "No architecture patterns needed for constant definitions", "blocked_by": null},
      {"phase_name": "COMMIT", "phase_index": 7, "status": "EXECUTED", "started_at": "2026-01-29T12:54:00Z", "ended_at": "2026-01-29T12:55:00Z", "duration_minutes": 1, "outcome": "SUCCESS", "notes": "Step completed; files ready for commit", "blocked_by": null}
    ]
  },

  "quality_gates": {
    "test_coverage_minimum": 80,
    "all_acceptance_tests_pass": true,
    "no_linting_errors": true
  }
}
