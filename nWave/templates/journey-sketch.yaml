# Journey Sketch Schema Template
# Used by Luna (leanux-designer) to create journey artifacts
# Version: 1.0

schema_version: "1.0"
template_type: "journey-sketch"
owner: "leanux-designer"

# =============================================================================
# JOURNEY SCHEMA
# =============================================================================

journey_schema:
  description: "Schema for user journey artifacts produced by Luna"

  journey:
    name: "{goal-name}"
    goal: "{What user is trying to accomplish}"
    persona:
      name: "{Persona name}"
      role: "{Persona role}"

    emotional_arc:
      start: "{Initial emotional state - e.g., Anxious}"
      middle: "{Mid-journey state - e.g., Focused}"
      end: "{Final emotional state - e.g., Confident}"

    trigger: "{What starts this journey}"
    success_criteria: "{How user knows they succeeded}"

  steps:
    - id: 1
      name: "{Step Name}"
      command: "{CLI command or user action}"

      tui_mockup: |
        ┌─ Step {N}: {Name} ──────────────────────────────────────┐
        │ $ {command}                                              │
        │                                                          │
        │ {Output line 1}                                          │
        │ {Output with ${variable}} ◄── {source_of_truth}         │
        │                                                          │
        │ {Prompt or next action}                                  │
        └──────────────────────────────────────────────────────────┘

      shared_artifacts:
        - name: "{artifact_name}"
          source: "{single source of truth file}"
          displayed_as: "${variable}"
          consumers:
            - "{Step N: where it appears}"

      emotional_state:
        entry: "{How user feels entering step}"
        exit: "{How user feels after step}"

      user_decision:
        prompt: "{Decision prompt if any}"
        options:
          - input: "{option}"
            next_step: "{next_step_id or 'exit'}"

      integration_checkpoint: |
        ✓ {artifact} matches {source}
        ✓ {artifact} consistent with Step N

      gherkin: |
        Scenario: {Step description}
          Given {precondition}
          When {action}
          Then {observable outcome}
          And shared artifact "${variable}" matches {source}

  integration_validation:
    shared_artifact_consistency:
      - artifact: "{name}"
        must_match_across: [1, 2, 3]
        failure_message: "{Integration error description}"

    cross_step_dependencies:
      - from_step: 1
        to_step: 2
        dependency: "{Description}"
        data_flow: ["{artifacts}"]

# =============================================================================
# SHARED ARTIFACT REGISTRY SCHEMA
# =============================================================================

shared_artifact_registry:
  description: "Schema for tracking shared artifacts across journey"

  artifacts:
    "{artifact_name}":
      source_of_truth: "{canonical file path}"
      consumers:
        - "{Step N: description of usage}"
      owner: "{responsible feature/component}"
      integration_risk: "HIGH|MEDIUM|LOW"
      risk_explanation: "{Why this matters}"
      validation: "{How to verify consistency}"

# =============================================================================
# COMMON ARTIFACTS TO TRACK
# =============================================================================

common_artifacts:
  version:
    typical_source: "pyproject.toml"
    common_consumers:
      - "CLI --version output"
      - "About command"
      - "README.md"
      - "Install confirmation"
    risk: "HIGH - version mismatch breaks user trust"

  install_path:
    typical_source: "config/paths.yaml or constants.py"
    common_consumers:
      - "Install script"
      - "Uninstall script"
      - "Documentation"
    risk: "HIGH - path mismatch breaks installation"

  repo_url:
    typical_source: "pyproject.toml or config"
    common_consumers:
      - "README.md"
      - "Error messages"
      - "Install docs"
    risk: "MEDIUM - URL mismatch breaks external links"

  agent_count:
    typical_source: "Build output / dist/ide/agents/"
    common_consumers:
      - "Build summary"
      - "Install confirmation"
    risk: "LOW - cosmetic but indicates build health"

# =============================================================================
# OUTPUT FILE PATTERNS
# =============================================================================

output_files:
  journey_yaml:
    pattern: "docs/design/ux/journey-{name}.yaml"
    description: "Structured journey schema"

  journey_visual:
    pattern: "docs/design/ux/journey-{name}-visual.md"
    description: "ASCII art journey with TUI mockups"

  journey_gherkin:
    pattern: "docs/design/ux/journey-{name}.feature"
    description: "Gherkin scenarios for E2E testing"

  artifact_registry:
    pattern: "docs/design/ux/shared-artifacts-registry.md"
    description: "Shared artifact tracking (updated per journey)"
