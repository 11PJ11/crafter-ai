# DES Audit Trail

Immutable audit logs for nWave workflow traceability.

## Structure

- `audit-YYYY-MM-DD.log`: JSONL format with daily rotation
- Append-only (no modifications to existing entries)
- SHA256 content hashing for immutability verification

## Events Logged

- `TASK_INVOCATION_STARTED`: Agent execution begins
- `TASK_INVOCATION_VALIDATED`: Pre-invocation hooks passed
- `PHASE_STARTED`: TDD phase begins (e.g., RED_UNIT, GREEN, REFACTOR)
- `PHASE_COMPLETED`: TDD phase finishes
- `SCOPE_VIOLATION`: File modified outside declared scope
- `TIMEOUT_WARNING`: Phase execution exceeding threshold

## Query Examples

```bash
# Filter violations
grep '"event":"SCOPE_VIOLATION"' audit-*.log | jq .

# Count events by step
jq -r 'select(.event=="SCOPE_VIOLATION") | .step_path' *.log | sort | uniq -c

# View phase execution timeline
jq -r 'select(.event | startswith("PHASE_")) | "\(.timestamp) \(.step_path) \(.phase_name) \(.event)"' audit-*.log
```

## Retention Policy

- Daily logs retained for 90 days
- Archive to `docs/evolution/audit-archive/` after 90 days
- No automatic deletion (manual cleanup only)
